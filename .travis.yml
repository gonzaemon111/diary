language: ruby
rvm:
- 2.6.1
env:
  global:
  - CODECOV_TOKEN: "23bdf18e-468c-4c3f-8d24-48749a60c296"
  - DEVISE_TOKEN_AUTH_SECRET_KEY="secrets"
  - secure: "T2U1ynl0U1axUPIcJ2T9kBWsfuCCXvv7+Xa99l3SzhYUEEyzQBcOCzAdnt1HjTlqMieZkzEwucD1T572clgJ8DHkE2iBNT47JiLdvoCB9TFrulTunCKhRl3qO/8C/mPlgDbO1G1oBa84NTly4K4d3N0n4oWPr8B1jcqsJkoGxXOZTw1lSy72FU1ALt/Q2Gktq0o4p4i/0jC17F6VfSnSgpK4OCEhh0K64tCW5C5jMWxTo9IHA5TQAKnrkM3bpPrjhaFC7b5WNWCcg/WJaDAscxo0cAM467+hlR476TjlFeP6uDsbsAW8iWaFntxRG4MKfoiXgcsbyw80UHUUKLJP3RpGrc6l59SKpq2IMCvphBUcIM1MSh9ApZPm4XSaQm//ZKbQAKGpyRj99f6Wi70UVvvQuKvbugitaiXnlTsq8OVGJDNsV9A8Rui7FfBXBSNL/MUjpEfKYib934c7LU+GoLc2A+5iH3cNQvBdxjyYQlcnEWCsU3Vis5OWu1/CaOTCHUEdWwiCsQWL+VTrW+FxJ1pkE0LSEMCGNOI/msQ+7rJaVuSjnZgQfoIfv0iP3ZS1hkftWrsgkqccmipmxvcDNfwuvxo+eDEJd/LcQAslc/fS7s6j+sGEtVbCLWzJsZjaPc6vs279ROKd9Bep63g83aviVnBIanvSApIYlPwtNpg="
  - secure: "YcANGD4MVRySp8hJlUWTrqaTvpIy02fqBnPVkxBvsiqNRLY4dXTkWLW4f1bQzNL+1VsixAcQ6LkxuVH6JBS76oHQ8fMGBUOxN7r2yPldxP/tYivlvQFbIcdyA5vwyEs46yrCDnblQAvvmRNovsXJH6mOanfwGd1WAepYmXUXRwwzMFz0rLtICo3YnUmSyu9vItErRIrnKOZ7eqoHUeFo0A3dOlmj1oZccl4euzCmDQLZlzu8U07GZrR6Vzv47fTsDI9gKQTo+OkUHKDTuZXFWSMZsWkpNs7CnZkd7FVvqw9UCKPnMrO3b7MN+54DXFCQlLpdwpp7Ik+jmrgzSurPCODaqNQAzJi+J67E9tNs7fBxhx51gkOQvuqSEu4nwiBYP5DgPEGjP4G2BNSvAmlWbKOrWS7ByzutNnLr8rvKtUCyshVNQrJ8xgJP2Qy0YOeUi3uad8lZ3mW4aveJ72qb8jfya0F4GjX81ZOwXlzc8xxaKywfPUWg746wncGCKLQ67WojPN1ZL7kwj5dncf7GGHl8dkmms58Ng+K6CtgSUwVTRTJWXLnYtaFokbm/4CIXo+XfE2jXf/531K/7BiHa6uPsZINlYv08evjtqXYn4M8eQ+ER2MUvcE1JOT6Ox2EIEtrpooUkJI1GgNGRyobFufD5CzmPVvnmMk7IJiL25Z4="
  - secure: "sgjDM525pU+6Zg3dZaZUbzLOeffWWsOq3MoUyGJG2tck6/4u4rVFY6bELnYL5UZ4K8x29ZA3u/aTJVgftsiV83sHmC8cKmBF6bVRZPyaZ5nQfwm28iBMo1v2i0XTtxzUhcaiLGfIU/UkZkom/xsACpoJ+qLPN3QC4AiVWn8yKlZxY3bwi902soCR2XZ9NZIqvk0IAb1hNbK/o6JzG4Fwr/i57h5wStsmk0/R9SSpBTevJOwn1sAR4DOV+Uf+dOUVGNhEhoYNeV78vMzf4kcSy/McgRqAS25Tt36sJDmisoNlRG1bDFH01f82cnomnaeBf/X3sy7gqaN0Js/bRFmd9iEQNt6/B8SRAEmYHh/fG9GzKtUtA/pDBrnldYMGNjyzAdBBTAsvvopuUJ2jn5wxhXRwQB2fGeyne1WUW6pcfz5FzQdl4p9YAV9BP4aEbtRWIWVrLBarEwwtUPRzWp44Wo7lvh6Mgn606T6LoMizBxmOG9be8O1K5al/gndzF7KZhBNbDu7Qq1WqyZxxI5Ye3byjaaOLUFHg2hobIPKscjPVU6dOttZSfimEhVX3sMclAtakHH0/Ldeo2vDEnQAZ4A0+qI3v3ficRZLHXXwD0e2ns6fY6Y4S7HBNzDH6l7aWGOREMU1od++2WzWxsWmz7Jx8SXMImxXJepAn7kK/YrA="
  - secure: "QyEwPXXYyCw1HAaJMOPFfd0sfGIGnbb4Xav1uf8qh50x5p+AgPCsPQ3pVkTzbIqY/Z0A1gpYs1V7gjBVd8YwODi+PVpO1kjWvA9ISB8mfsuz2Fx6Uw0G+O9leKlYEv3xvo5Q4+xCglaQaX2Zh1TXbRGMIZoLyNj+IOsn0aDx6oB6B0P/4lcehjQbE4eyXxZJvsNfWrS2f0+bmMb3+dENXAEnosJnjyvzPHga1bVJ1ZOhto58tfa1CotnAefm92myvbv1mlA3T6oUcpB5oZFppWtCY+B+GWTfX43EeLimgJqW1EJduvxmsRxrY5E59vthgs3/9PUjGvLtV9UI1pwHCqKyk+dSid70s7U5q9sGVLcOT4I3TvREwYAkGqCor5y+PkQk4dZ6FWEiIFMSUHwahDogaPLIeTOtR5C9aNn/wPRVDmCbn3iAuJU/ovvabkykO2rsN2cXi2c1++x5bovegDeF0y+D7N8ftqEQfoDPGgjNlxtIBa+DgGU2Bdzwh/HGcqKr8PtF2zIheyt3u2YjXZ0msfPyg7wUXsBg1x9j2UNh2t9s3M4ui5GKWBdkHB3Fa3zjFX/SM9EyD+JZhpFV8I81pFaYVBZofczf+1zmiZFeioB3SsoZN5CZ2v1YP4bczXkSVo0G8hsNHc2A65yhrrC4ed5dfsfPEwQXgokxtmw="
  - secure: "PltY6XW+0chySf7VT+UYoSt7ho0GjJi72O0bOBoAH/T2QGWfPeqgN8Y1SB26FgkiBCaQTmCCASAlEqMz1Zspofhu9oxU1QFtzXarMPL0JSAMCvcprmGLOdLgt1RcdB10UYc1UtsEsb42cydW5Fen+sgC8FL9ga0EYfl9HD517mDsz+w5COoFEeZxNOlnFtX3rRmTC/4Gv11u2VIihhPT2PKiEs0mFIWKEp5h1owqEiN8rieHHs6HqXKrLiOVdsOKN2MB42aWF34lvTPveiHrInSxoMBJAm5Fc+JfTcBBgs9E0ncg9CnNGu6HDG5ZsvocseAqo5qTsJuEOmF8AmVCNgnBYA/KJ2UfX1OoXcdTKLCHpBPjzXkZ3+SsIu5nxhhqkramfe5728xaXWVzTnKkBgwgn69Wy1qMv2HTbz4GWUlrTMi4QamL4GLhBZWxX0ri8SbA4j8RA4KIPXc7xLXiW4TBC5EuX4SoaVO2yKhUJX4PVAg16Cw+4TVoAXA2VZIhK8mR5C4ZF9q/RrmvJzbpAOW5xPxGEyAfvnlisxmqr8G8HFc1+Xa9sa8/RbvFkq+e7ICUsXmMQ5rvKf9Kwp8fVwxgujVviyare2m0C4A3Fn9uxGQTYUXVob+00mpp1D7OtCb6jM6GJkXJJ4RvTPjheZWvcqZYZ7PVkVzDPxOI+gM="
services:
- mysql
- redis-server
- imagemagick
before_script:
- cp -f .env.example .env
- cp -f config/database.travis.yml config/database.yml
- bundle install
script:
- bundle exec rails db:create RAILS_ENV=test
- bundle exec rails db:migrate RAILS_ENV=test
- bundle exec rspec --color --require spec_helper --format progress spec
- bundle exec rubocop
after_failure:
- mysql -e 'show databases;'
- cat ./log/test.log
- echo $RAILS_ENV
